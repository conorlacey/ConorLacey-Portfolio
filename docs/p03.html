<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 3</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 3</h1>

</div>


<pre class="r"><code>suppressWarnings(library(tidyverse))</code></pre>
<pre><code>## â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
## âœ” dplyr     1.1.0     âœ” readr     2.1.4
## âœ” forcats   1.0.0     âœ” stringr   1.5.0
## âœ” ggplot2   3.4.1     âœ” tibble    3.2.1
## âœ” lubridate 1.9.2     âœ” tidyr     1.3.0
## âœ” purrr     1.0.1     
## â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
## âœ– dplyr::filter() masks stats::filter()
## âœ– dplyr::lag()    masks stats::lag()
## â„¹ Use the ]8;;http://conflicted.r-lib.org/conflicted package]8;; to force all conflicts to become errors</code></pre>
<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>This portfolio is a continuation of my previous one. In this one I
want to make graphics that show how exactly the prior and posterior
distribution should look for the spike and the slab.</p>
</div>
<div id="the-spike" class="section level3">
<h3>The Spike</h3>
<p>The spikeâ€™s prior is simply the probability of the effect (in the
case of my thesis, this would be dMACS) being zero. Since we weight the
spike prior equally to the slab, this should simply be a straight
vertical line at 0 with length of 0.5. The y-axis represents the
probability</p>
<pre class="r"><code>spike_prior &lt;- tribble(~dMACS, ~Density,
                       0, 0,
                       0, 0.5)

spike_prior_graph &lt;- spike_prior %&gt;% ggplot(aes(x=dMACS,y=Density))+
  geom_line(color = &quot;blue&quot;, linewidth = 1.5, alpha = 0.5) +
  xlim(-4,4)
spike_prior_graph</code></pre>
<p><img src="p03_files/figure-html/spike-prior-1.png" width="672" /></p>
<p>Ok this is good, but now letâ€™s show what happens when we present data
that in favor of it, that is the probability of the effect being zero
increases a bit. ### Calculating dMACS</p>
<pre class="r"><code>spike_post &lt;- tribble(~dMACS, ~Density,
                            0, 0,
                            0, 0.52)

spike_post_graph &lt;- spike_post %&gt;% ggplot(aes(x=dMACS,y=Density))+
  geom_line(color = &quot;blue&quot;, linewidth = 1.5, alpha = 0.5) +
  xlim(-4,4)
spike_post_graph</code></pre>
<p><img src="p03_files/figure-html/spike-posterior-1.png" width="672" /></p>
<p>Now of course this all doesnâ€™t look too interesting, all I did was
increase the height of the line. However, now I will show the prior and
posterior DISTRIBUTION of the slab and this is where things start to
look cool.</p>
</div>
<div id="the-slab" class="section level3">
<h3>The Slab</h3>
<p>The slab-prior is quite easy. It is just a normal distribution
centered at 0 and with standard deviation of 1.</p>
<pre class="r"><code>x&lt;-seq(-4,4, length.out = 1e4)
y&lt;-dnorm(x)
y&lt;-y/max(y)*(.5)
slab_prior &lt;- tibble(x = x, y = y)

graph_prior_graph&lt;-slab_prior %&gt;% ggplot(aes(x=x,y=y))+
  geom_line(alpha=0.5, color = &quot;red&quot;, linewidth = 1.5) + 
  labs (title = &quot;Prior Slab&quot;,
        x = &quot;dMACS&quot;,
        y = &quot;Density&quot;)
graph_prior_graph</code></pre>
<p><img src="p03_files/figure-html/slab-prior-1.png" width="672" /></p>
<p>Again nothing new, just a normal distribution. However, what if we
introduce data that shows that the effect size is not 0 and there is
actually an effect occuring. If this is the case, then we should update
our prior distribution of the slab. In this case letâ€™s assume we
calculated a new posterior distribution that is N(.29,.14).</p>
<pre class="r"><code>x&lt;-seq(-4,4, length.out = 1e4)
y&lt;-dnorm(x,.29,.14)
y&lt;- y/max(y)*(.47)
slab_post &lt;- tibble(x = x, y = y)

slab_post_graph &lt;- slab_post %&gt;% ggplot(aes(x=x,y=y)) + 
    geom_line(alpha=0.5, color = &quot;red&quot;, linewidth = 1.5) +
    labs (title = &quot;Posterior Slab&quot;,
          x = &quot;dMACS&quot;,
          y = &quot;Density&quot;)
slab_post_graph + 
  xlim(-1,1) +
  ylim(0,0.5)</code></pre>
<pre><code>## Warning: Removed 7500 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="p03_files/figure-html/slab-posterior-1.png" width="672" /></p>
<p>Wow! Look at that. Clearly there is a change once new data is
introduced. The data errs on the side that there is an effect, therefore
the posterior distribution is to the right of zero. The data also
becomes less spread if you notice the y-axis. You should also notice
that its height has decreased. This is because we are also updating the
prior probability of there being an effect which is just 1 minus the
posterior probabilty of there being no effect.</p>
</div>
<div id="prior-spike-and-slab" class="section level3">
<h3>Prior Spike and Slab</h3>
<p>Ok well now I have quite a lot of graphs here, but perhaps it might
be useful to also display the graphs with the spike and the slab. I
shall make two graphs, one with the prior spike and slab and one with
the posterior spike and slab.</p>
<pre class="r"><code>  ggplot() +
  geom_line(data = spike_prior, aes(x=dMACS,y=Density, color = &quot;Spike&quot;),
            alpha=0.5, linewidth = 1.5) + 
  geom_line(data = slab_prior, aes(x=x,y=y, color = &quot;Slab&quot;),
            alpha=0.5, linewidth = 1.5) + 
  labs (title = &quot;Prior Spike and Slab&quot;,
        x = &quot;dMACS&quot;,
        y = &quot;Density&quot;,
        color = &quot;&quot;) + 
  scale_color_manual(values = c(&quot;Slab&quot; = &quot;red&quot;, &quot;Spike&quot; = &quot;blue&quot; )) +
  xlim(-4,4)</code></pre>
<p><img src="p03_files/figure-html/prior-spike_and_slab-1.png" width="672" /></p>
<p>Good. Now letâ€™s make the posterior.</p>
</div>
<div id="posterior-spike-and-slab" class="section level3">
<h3>Posterior Spike and Slab</h3>
<pre class="r"><code>  ggplot() +
  geom_line(data = spike_post, aes(x=dMACS,y=Density, color = &quot;Spike&quot;),
            alpha=0.5, linewidth = 1.5) + 
  geom_line(data = slab_post, aes(x=x,y=y, color = &quot;Slab&quot;),
            alpha=0.5, linewidth = 1.5) + 
  labs (title = &quot;Posterior Spike and Slab&quot;,
        x = &quot;dMACS&quot;,
        y = &quot;Density&quot;,
        color = &quot;&quot;) + 
  scale_color_manual(values = c(&quot;Slab&quot; = &quot;red&quot;, &quot;Spike&quot; = &quot;blue&quot; )) +
  xlim(-1,1)</code></pre>
<pre><code>## Warning: Removed 7500 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="p03_files/figure-html/posterior-spike_and_slab-1.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
