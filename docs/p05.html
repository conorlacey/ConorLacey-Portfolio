<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 5</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 5</h1>

</div>


<div id="libraries" class="section level2">
<h2>Libraries</h2>
<pre class="r"><code>suppressWarnings(library(tidyverse))</code></pre>
<pre><code>## â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
## âœ” dplyr     1.1.0     âœ” readr     2.1.4
## âœ” forcats   1.0.0     âœ” stringr   1.5.0
## âœ” ggplot2   3.4.1     âœ” tibble    3.2.1
## âœ” lubridate 1.9.2     âœ” tidyr     1.3.0
## âœ” purrr     1.0.1     
## â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
## âœ– dplyr::filter() masks stats::filter()
## âœ– dplyr::lag()    masks stats::lag()
## â„¹ Use the ]8;;http://conflicted.r-lib.org/conflicted package]8;; to force all conflicts to become errors</code></pre>
<pre class="r"><code>suppressWarnings(library(dmacs))
source(&quot;functions2.R&quot;)</code></pre>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this portfolio I will be running simulations to explore the nature
of dMACS_Shrunk in comparison to the original dMACS measure.</p>
<p>To do this we will be running conditions on sample size, prior
probabilities, effect sizes, and whether or not the mean eta value
(i.e., the latent variable) is equal across groups. To be more specific
our sample size conditions will include sizes of 250, 500, and 1000. Our
prior probabilities will include prior probabilities of the null being
true of .25, .5, and .75. The effect size conditions will include effect
sizes of 0.1, 0.5, and 0.9. Lastly, the mean eta value conditions will
include one condition where they are exactly equal and another where
there is a mean difference of 1.</p>
<p>In total, we will have 54 conditions. This is quite a lot and I want
to calculate these conditions 500 times! Therefore, the most intuitive
way I believe I can organize this is by making a 500 X 54 data frame.
Make sense?</p>
</div>
<div id="data-frames" class="section level2">
<h2>Data Frames</h2>
<p>Alright letâ€™s do this one step at a time. First, letâ€™s create the
data frame.</p>
<pre class="r"><code>set.seed(9420)

names &lt;- c(1:54) %&gt;% as.character()

dat_dMACS &lt;- matrix(nrow = 500, ncol = 54) %&gt;% data.frame() %&gt;% 
  setNames(c(names))
dat_dMACS_S &lt;- matrix(nrow = 500, ncol = 54) %&gt;% data.frame() %&gt;% 
  setNames(c(names))</code></pre>
</div>
<div id="for-loop-simulations" class="section level2">
<h2>For Loop Simulations</h2>
<p>To conduct these simulations I will do a series of if statement
wrapped in a for loop. This loop should calculate a dMACS and
dMACS_Shrunk estimate under each of the 54 conditions and loop back to
do this again 500 times.</p>
<pre class="for"><code>for (i in 1:500){
  for (cond in 1:54){
    if (cond %in% c(1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52)){
      N.R &lt;- 250
      N.F &lt;- 250
    }
    if (cond %in% c(2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53)){
      N.R &lt;- 500
      N.F &lt;- 500
    }
    if (cond %in% c(3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54)){
      N.R &lt;- 1000
      N.F &lt;- 1000
    }
    if (cond %in% c(1,2,3,10,11,12,19,20,21)){ # dMACS 0.1 mean equal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .634 #loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.05 #intercept for focal group
    }
    if (cond %in% c(28,29,30,37,38,39,46,47,48)){ #dMACS 0.1 mean unequal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .61 #loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.05 #intercept for focal group
    }
    if (cond %in% c(4,5,6,13,14,15,22,23,24)){ #dMACS 0.2 mean equal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .61 #loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.3 #intercept for focal group
    }
    if (cond %in% c(31,32,33,40,41,42,49,50,51)){ #dMACS 0.2 mean unequal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .61 #loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.29 #intercept for focal group
    }
    if (cond %in% c(7,8,9,16,17,18,25,26,27)){ #dMACS 0.9 mean equal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .606#loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.55 #intercept for focal group
    }
    if (cond %in% c(34,35,36,43,44,45,52,53,54)){ #dMACS 0.9 mean unequal
      load.R &lt;- .6 #loading for the reference group
      load.F &lt;- .595 #loading for focal group
      int.R &lt;- 0 #intercept for reference group
      int.F &lt;- 0.55 #intercept for focal group
    }
    if (cond %in% c(1:9,28:36)){
      priorPH0  &lt;- 0.25
    }
    if (cond %in% c(10:18,37:45)){
      priorPH0 &lt;- 0.5
    }
    if (cond %in% c(19:27,46:54)){
      priorPH0 &lt;- 0.75
    }
    if (cond %in% c(1:27)){ #mean equal
      mean.F &lt;- 0
    }
    if (cond %in% c(28:54)){ #mean unequal
      mean.F &lt;- 1
    }
    
    mean.R &lt;- 0
    
    
    sd.R &lt;- 1
    sd.F &lt;- 1
    
    #Set up latent variable
    eta.R &lt;- rnorm(N.R, mean.R, sd.R)
    eta.F &lt;- rnorm(N.F, mean.F, sd.F)
    
    y.R &lt;- load.R*eta.R + int.R #model-implied scores for reference group
    y.F &lt;- load.F*eta.F+ int.F #model-implied scores for focal group
    
    datR &lt;- data.frame(eta = eta.R, y = y.R, group = &quot;R&quot;)
    datF &lt;- data.frame(eta = eta.F, y = y.F, group = &quot;F&quot;)
    dat  &lt;- bind_rows(datR,datF)
    
    dat %&gt;% ggplot(aes(x = eta, y = y, color = group)) +
      geom_line(linewidth = 1) +
      labs(x = &quot;Eta&quot;,
           y = &quot;Estimated Response&quot;) +
      geom_line(data = datF,
                aes(x = eta, y = dnorm(eta, mean(eta), sd(eta)), color = NULL),
                linetype = &quot;dashed&quot;) +
      xlim(-3,3) +
      ylim(0,1.2)
    
    sd.pooled.test.num &lt;- ((length(y.R)-1)*sd(y.R)) + ((length(y.F)-1)*sd(y.F))
    sd.pooled.test.denom &lt;- (length(y.R) - 1) + (length(y.F) - 1)
    sd.pooled.test &lt;- sd.pooled.test.num/sd.pooled.test.denom
    
    #dMACS
    dMACS &lt;- item_dmacs(load.R, #loading, R
                        load.F, #loading, F
                        int.R, #intercept, R
                        int.F, #intercept, F
                        mean(eta.F), #mean (both groups)
                        var(eta.F), #variance (both groups, but it would be the focal group if they didn&#39;t have the same variance)
                        sd.pooled.test #pooled standard deviation (again, this is basically arbitrary)
    )
    
    dat_dMACS[i,cond] &lt;- dMACS
    
    #dMACS_Shrunk 
    sigmaSlab &lt;- 1
    
    ybarExpl &lt;- get.dMACS(y.R, y.F, eta.R, eta.F)
    ybarExpl
    
    nExpl &lt;- length(y.R)
    
    upMAExpl &lt;- updatePar(priorPH0, sigmaSlab, nExpl, ybarExpl[1L])
    ciMAExpl &lt;- postStat(upMAExpl)
    
    tbExplicit &lt;- data.frame(t(c(upMAExpl, ciMAExpl)))
    names(tbExplicit) &lt;- c(&quot;ph0&quot;, &quot;mu1&quot;, &quot;sd1&quot;, &quot;Lower&quot;, &quot;Upper&quot;, &quot;modelAveraged&quot;)
    
    dMACS_Shrunk &lt;- (1-tbExplicit[1])*tbExplicit[2]
    
    dat_dMACS_S[i,cond]&lt;- dMACS_Shrunk
  }
}</code></pre>
</div>
<div id="output" class="section level2">
<h2>Output</h2>
<p>Yay! Simulations done. Now I will save the outputted data files.</p>
<pre class="output"><code>write.csv(dat_dMACS, file = &quot;dat_dMACS.csv&quot;)
write.csv(dat_dMACS_S, file = &quot;dat_dMACS_S.csv&quot;)</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
